<!doctype html><html lang=ru-ru><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Алексей Жидков"><meta name=description content="https://azhidkov.pro/"><meta property="og:site_name" content="Алексей Жидков"><meta property="og:title" content="Основные структуры дизайна програм - Алексей Жидков"><meta property="og:description" content="К каким структурам дизайна програм следует стремится, для того чтобы программа была поддерживаемой"><meta property="og:type" content="website"><meta property="og:url" content="https://azhidkov.pro/drafts/210901-basic-structures/210912-basic-patterns/"><meta property="og:image" content="https://azhidkov.pro/"><meta name=twitter:card content="summary"><meta name=twitter:site content="https://azhidkov.pro/drafts/210901-basic-structures/210912-basic-patterns/"><meta name=twitter:image content="https://azhidkov.pro/"><base href=https://azhidkov.pro/drafts/210901-basic-structures/210912-basic-patterns/><title>Основные структуры дизайна програм - Алексей Жидков</title><link rel=canonical href=https://azhidkov.pro/drafts/210901-basic-structures/210912-basic-patterns/><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700"><link rel=stylesheet href=/css/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css><link rel=stylesheet href=https://azhidkov.pro/css/custom.css><link rel=stylesheet href=https://azhidkov.pro/css/github.css><link rel=stylesheet href=https://azhidkov.pro/css/JetBrains-Mono.css><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=alternate href=https://azhidkov.pro/index.xml type=application/rss+xml title="Алексей Жидков"><link href=https://azhidkov.pro/index.xml rel=feed type=application/rss+xml title="Алексей Жидков"><meta name=generator content="Hugo 0.80.0"></head><body><main class=wrapper><link rel=apple-touch-icon sizes=180x180 href=apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://azhidkov.pro/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://azhidkov.pro/favicon-16x16.png><link rel=manifest href=site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet type=text/css><nav class=navigation><section class=container style=height:100%><img src=https://azhidkov.pro/images/logo.svg class=logo>
<a class=navigation-title href=/>Алексей Жидков</a>
<input type=checkbox id=menu-control>
<label class="menu-mobile float-right" for=menu-control><span class="btn-mobile float-right">&#9776;</span><ul class=navigation-list><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/book/ergo>Книга</a></li><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/posts>Блог</a></li><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/portfolio>Портфолио</a></li><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/>Контакты</a></li><li class=mobile-menu-lang-separator-full><hr></li><li class=multilingual-separator><p>|</p></li><li class="navigation-item align-left"><a href=https://azhidkov.pro/en/>En</a></li></ul></label></section></nav><div class=content><section class="container page"><article><header><h1>Основные структуры дизайна програм</h1></header><aside class="admonition-block note" role=note><h6 class="block-title label-only"><span class=title-label>Note:</span></h6><p>Следить за обновлениями блога можно в моём канале: <a href=https://t.me/ergonomic_code>Эргономичный код</a></p></aside><section class="doc-section level-1"><h2 id=_введение>Введение</h2><p>(<mark>todo: слишком много хорошо - плохо:)</mark>)
(<mark>todo: как мне в ситуации, когда надо и научить и сделать хороший проект силами интернов</mark>)</p><p>Я сейчас среди прочего отвечаю за интернатуру по Java в Сиберина.Про.
Интернатура устроена таким образом, что интерны, при первой возможности, подключаются к разработке проектов, предназначенных для проверки бизнес гипотез компании.
И так вышло, что сейчас мне надо разработать такой проект силами интернов.
Но если проект выстрелит, то он пойдёт в бой, поэтому его надо написать хорошо.
Поэтому мне надо научить интернов как писать хорошо.</p><p>Это я и делаю в этом посте.
Так как же сделать хорошо?</p><p>Сделать это просто - надо спроектировать программу так, чтобы он хорошо выглядела со всех ракурсов.
Сейчас же я наблюдаю существенный перекос в сторону одного из ракурсов - статической структуры реализации программы.</p><p>На мой же взгляд большее значение для хорошей программы имеет структура предметной области.</p><p>Кроме того, программисты сейчас забыли об одной из жемчужин 70ых годов - структурном дизайне.
С точки зрения статической структуры он потерял актуальность и уступил место чистой архитектуре.
Но когда дело доходит до динамической структуры во время выполнения программы, он всё ещё актуален.</p><p>Наконец, даже хорошая архитектура, будучи "скрытой за деревьями", быстро протухнет, т.к. бумажная документация моментально устареет, и новые члены команды не смогут восстановить архитектуру программы, скрытую за деталями реализации.</p><p>В этом посте, я кратко напомню существующие подходы к проектированию реализации программы и расскажу свои текущеие видения подхода к проектированию предметной области.
Наконец, изложу свои аргументы, почему программы следует разбивать на модули и пакеты исходя из структуры предметной области, а не реализации.</p><section class="doc-section level-2"><h3 id=_структуры_реализации>Структуры реализации</h3><p>Под хорошими и я, и большинство других авторов, понимю программы, которые легко и безопасно модифицировать.
Как писать хорошие программы, проторазработчики стали задумываться как только размер программ вышел за пределы одного экрана.
Это случилось в 60-ые годы. (<mark>todo: шуточка?</mark>).</p><p>И к настоящему времени открыли целый ряд структур реализации, присущий хорошим программам:
. Структурный дизайн и (<mark>todo: ориентация на трансформацию</mark>)
. Слоёная архитектура
. Принцип инверсии зависимостей
. Чистая архитектура
. Концепция чистого ядра/императивной оболочки</p><p>(<mark>todo: структурный дизай → ДИП в статике, но в рантайме программы всё ещё имеют структрный дизайн</mark>)</p><div class=quote-block><blockquote><p>Although I’m too young to have done any work in the early days of batch sys-
tems, I don’t sense that people thought much of layers in those days. You wrote
a program that manipulated some form of ﬁles (ISAM, VSAM, etc.), and that
was your application. No layers need apply.
The notion of layers became more apparent in the ’90s with the rise of client–
server systems
PoEAA</p></blockquote></div><p><a class=bare href=https://www.eecs.ucf.edu/~eurip/papers/dijkstra-the68.pdf>https://www.eecs.ucf.edu/~eurip/papers/dijkstra-the68.pdf</a></p><section class="doc-section level-3"><h4 id=_структурный_дизайн>Структурный дизайн</h4><p>Ещё в 70-ых годах Ларри Константин обнаружил<a class=footnote-ref id=_footnoteref_1 href=#_footnote_1 title="View footnote 1" role=doc-noteref>[1]</a> общую для дешёвых (<mark>todo: красивый синоним</mark>) програм структуру кода:</p><div class=image-block><img src=/posts/21/09/images/transform-oriented-structure-base-rus.svg alt="transform oriented structure base rus"></div><div class="olist loweralpha"><ol class=loweralpha type=a><li>Слоёная архитектруа</li><li>Чистая архитектура</li><li>Функциональное ядро, императивная оболочка</li><li>Привязка ко спрингу<ol class=arabic><li>Структура предметной области</li></ol></li></ol></div></section></section><section class="doc-section level-2"><h3 id=_видите_объект_а_он_есть>Видите объект? А он есть</h3><div class="olist loweralpha"><ol class=loweralpha type=a><li>Данные</li><li>Поведение<ol class=lowerroman type=i><li>Простое</li><li>Сложное</li><li>Сложное с приватными данными</li><li>Переиспользуемое</li></ol></li><li>Основные связки<ol class=lowerroman type=i><li>Отсутствие циклов</li><li>Связки данных</li><li>Связка простого поведения с данными</li><li>Связка сложного поведения с данными</li><li>Связка сложного поведения с приватными данными и данными</li><li>Связка переиспользуемого поведения</li></ol></li><li>Домен как SDK предметной области<ol class=arabic><li>Что вперёд - предметная область или реализация</li></ol></li><li>Вперёд - предметная область, потому что за ней сложнее следить</li><li>Предыдущая работа<ol class=lowerroman type=i><li>Кричащая архитектура</li><li>Архитектурно-очевидное кодирование (Risk Driven approach)</li><li>Пакетирование по фичам</li><li>Пакетирование по компонентам</li></ol></li></ol></div></section><section class="doc-section level-2"><h3 id=_мой_вариант>Мой вариант</h3></section></section><section class="doc-section level-1"><h2 id=_заключение>Заключение</h2><p>Итого, для того чтобы получить хорошую архитектуру необходимо:
. "Плясать от печки" - предметной области, в частности от ДДД-агрегатов;
. Делать архитектуру видимой с первого взгляда - отражать её в структуре пакетов;
. Не допускать циклов в зависимостях модулей
. Про каждую функцию и класс понимать куда они ложится в диаграмме структуры <strong>чего?</strong>, чистой архитектуры и арихтектуры предметной области.
. И убедиться, что они ложатся только на один элемент каждой из диаграм
. Рассматривать домен, как SDK предметной области
. Реализовывать домен в функциональном стиле (так чтобы его можно было покрыть юнит тестами без моков)
. Стараться уносить максимум бизнес правил в домен
. Следовать принципам чистой архитектуры при проектировании статической структуры программы
. Следовать принципам структурного дизайна при проектировании динамической структуры программы</p></section><section class="doc-section level-1"><h2 id=_ссылки>Ссылки</h2></section><section class=footnotes aria-label=Footnotes role=doc-endnotes><hr><ol class=footnotes><li class=footnote id=_footnote_1 role=doc-endnote><a href=https://www.amazon.com/Structured-Design-Fundamentals-Discipline-Computer/dp/0138544719>Структурный дизайн, Константин, Йордон</a> <a class=footnote-backref href=#_footnoteref_1 role=doc-backlink title="Jump to the first occurrence in the text">↩</a></li></ol></section></article></section></div></main><script src=/js/app.js></script></body></html>