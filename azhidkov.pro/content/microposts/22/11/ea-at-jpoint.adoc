---
title: "–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–∞ JPoint"
date: 2022-11-18T08:25:37+07:00
draft: false
---
:source-highlighter: rouge
:rouge-theme: github
:icons: font
:sectlinks:
:imagesdir: /microposts/22/11/images

–ü—Ä–∏–≤–µ—Ç!

[line-through]#–£ –º–µ–Ω—è —Ä–µ–±—ë–Ω–æ–∫ –Ω–∞—á–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ö–æ–¥–∏—Ç—å –≤ –¥–µ—Ç—Å–∫–∏–π —Å–∞–¥!#
–ü–æ–∫–∞ –ø–∏—Å–∞–ª –ø–æ—Å—Ç - —Å–Ω–æ–≤–∞ –∑–∞–±–æ–ª–µ–ªü§¶‚Äç‚ôÇÔ∏è.

–ö–∞–∫ —ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –≤–∞—Å?
–í–æ-–ø–µ—Ä–≤—ã—Ö, –µ—Å–ª–∏ —É –≤–∞—Å —Å–µ–π—á–∞—Å –ø–µ—Ä–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –¥–æ —Ç—Ä—ë—Ö –ª–µ—Ç - –≤–µ—Ä—å—Ç–µ, —Å–≤–µ—Ç –≤ –∫–æ–Ω—Ü–µ —Ç—É–Ω–Ω–µ–ª—è –µ—Å—Ç—å, –≤–º–µ—Å—Ç–µ —Å —Å–∞–¥–æ–º —É –≤–∞—Å –Ω–∞—á–Ω—ë—Ç—Å—è –Ω–æ–≤–∞—è –∂–∏–∑–Ω—å:)

–ù–∞–ø—Ä–∏–º–µ—Ä, —É –≤–∞—Å —Å–Ω–æ–≤–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤—Ä–µ–º—è —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–æ—Å–∏–∫–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ:)
–ò —è –≤–æ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ–ª –¥–æ–∫–ª–∞–¥ c JPoint "[line-through]#–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥# https://www.youtube.com/watch?v=YBsihlkI1E8&list=PLVe-2wcL84b88Ec7BFQZ5aEcu_h6U9isn&index=3[TDD&DDD ‚Äî –≥–∞–π–¥ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏]".
https://git.codemonsters.team/guides/ddd-code-toolkit/src/branch/dev[–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–∫–ª–∞–¥–∞].

–≠—Ç–æ –æ—á–µ—Ä–µ–¥–Ω–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª, –ø—Ä–æ –∫–æ—Ç–æ—Ä—ã–π —è –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å "–ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –µ–≥–æ, –≤–æ–∑—å–º–∏—Ç–µ –î–∏–∞–≥—Ä–∞–º–º—É –≠—Ñ—Ñ–µ–∫—Ç–æ–≤ –¥–ª—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–æ–ª—É—á–∏—Ç–µ –≠–ü".
–ü–æ—ç—Ç–æ–º—É –≤ —Ü–µ–ª–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É, –Ω–æ —Ö–æ—á—É –ø—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ—á—å –æ—Ç —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é —è –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –∏ –æ—Ç–∫–∏–Ω—É–ª.
–ê –∏–º–µ–Ω–Ω–æ - https://fsharpforfunandprofit.com/rop/[Railway-oriented Programming] –Ω–∞ –º–æ–Ω–∞–¥–∞—Ö.

–ü—Ä–∏ —Ç–æ–º, —á—Ç–æ —Å–∞–º–∞ –∏–¥–µ—è –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∏ —è –ø—Ä–æ–¥–æ–ª–∂–∞—é –µ–π –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –≤ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º —Å—Ç–∏–ª–µ (guard-clause —Å –≤—ã–±—Ä–æ—Å–æ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è, "–ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–π–∏–π ROP"), –≤ —Å—Ç–∏–ª–µ –Ω–∞ –º–æ–Ω–∞–¥–∞—Ö –æ–Ω–∞ –Ω–µ –ø–æ–¥–æ—à–ª–∞ –ø–æ—Ç–æ–º—É —á—Ç–æ:

. –í –º–æ—ë–º –∫–æ–¥–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ 95% –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏—Ö –º–∞–ø–ø–∏–Ω–≥–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å HTTP-–æ—Ç–≤–µ—Ç–∞.
  –ò –°–∫–æ—Ç—Ç –í–ª–∞—à–∏–Ω, —Å–∞–º –ø–∏—à–µ—Ç, —á—Ç–æ https://fsharpforfunandprofit.com/posts/against-railway-oriented-programming/#2----dont-use-result-to-reinvent-exceptions[–Ω–µ –Ω–∞–¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ROP —Ç–∞–º, –≥–¥–µ –Ω—É–∂–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏—è].
. –í –ö–æ—Ç–ª–∏–Ω–µ –æ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —à—É–º–∞.
  –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –ö–æ—Ç–ª–∏–Ω–µ –±—É–∫–≤–∞–ª—å–Ω–æ –ª—é–±–æ–π –≤—ã–∑–æ–≤ –º–æ–∂–µ—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –±—É–∫–≤–∞–ª—å–Ω–æ –ª—é–±–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∂–¥—É—é –≤–µ—Ä—Ö–Ω–µ-—É—Ä–æ–≤–Ω–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–¥–æ –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å –≤ Result.runCatching, –Ω–∞–ø—Ä–∏–º–µ—Ä.
  –ò –≤–æ–æ–±—â–µ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –æ–±—ä—ë–º–∞—Ö –∫–æ–¥–∞ –≤–∏–¥–Ω–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –Ω–∏–∂–µ.

–í–æ—Ç –ø–µ—Ä–µ—á–µ–Ω—å –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤ (+ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏) —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∏–∑ https://git.codemonsters.team/guides/ddd-code-toolkit/src/branch/dev/src/main/kotlin/team/codemonsters/ddd/toolkit/domain/subscriberDataUpdate/SubscriberDataUpdateService.kt#L12[—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è]:

. –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏ –æ—Å–æ–∑–Ω–∞—Ç—å.
+
_–ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥ –ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∏–π ROP –ø—Ä–æ—â–µ —á–∏—Ç–∞—Ç—å –∏ –æ—Å–æ–∑–Ω–∞–≤–∞—Ç—å._

. —è–≤–ª—è–µ—Ç—Å—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
+
_–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü_

. –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ROP - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∫–∞–∫ –≤–æ–∑–º–æ–∂–Ω—ã–π –Ω–µ—è–≤–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
+
_–í –ö–æ—Ç–ª–∏–Ω–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è *–≤—Å–µ–≥–¥–∞* –æ–¥–∏–Ω –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–µ—è–≤–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.
–ò –µ—Å–ª–∏ –≤—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–µ—Ä–≤–∞–Ω–∏–∏ –ø–æ—Ç–æ–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è, —Ç–æ –ª—É—á—à–µ —ç—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –∞ –¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–º—É –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º—É —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É_

. –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞ –æ—Ç–¥–µ–ª–µ–Ω–∞ –æ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—â–µ–≥–æ —Å–ª–æ—è
+
_–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü_

. –ø—Ä–∏ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ —Å–∞–º —Å–µ—Ä–≤–∏—Å –≤—ã—Å—Ç—É–ø–∞–µ—Ç —Ç—É–ø–æ–π —Ç—Ä—É–±–æ–π, –∫–æ—Ç–æ—Ä—ã–π –º–∞–∫—Å–∏–º—É–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω canExecute/execute
+
_–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü_

. —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –Ω–µ –æ–±—è–∑–∞—Ç–∞–ª—å–Ω–æ - –º–æ–∂–Ω–æ –ø–æ–∫—Ä—ã—Ç—å –º–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤—ã–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç–µ—Å—Ç–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
+
_–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü_

. –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–∂–Ω–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏–ª—å–Ω–æ–π –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
+
_–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü_

–í –æ–±—â–µ–º –ø–∏—à–∏—Ç–µ –º–µ–Ω—å—à–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –≥–æ–¥–∞, –ø—Ä–æ–¥–æ–ª–∂–∞—è —Ä–∞–∑–¥–µ–ª—è—Ç—å –≤–≤–æ–¥-–≤–≤—ã–≤–æ–¥ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª–∏–∑—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö (–∏ —Ç–æ–ª—å–∫–æ –µ—ë) –≤ –≤–∏–¥–µ —á–∏—Å—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π - –∏ –±—É–¥–µ—Ç –≤–∞–º –ø—Ä–æ—Å—Ç–æ–µ –¥–µ–≤–µ–ª–æ–ø–µ—Ä—Å–∫–æ–µ —Å—á–∞—Å—Ç—å–µ:)

.–°—Ä–∞–≤–Ω–µ–Ω–∏–µ ROP-–∞ –Ω–∞ –º–æ–Ω–∞–¥–∞—Ö –∏ –ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–æ–≥–æ ROP-–∞
[cols="1,1"]
|===

a|
https://git.codemonsters.team/guides/ddd-code-toolkit/src/branch/dev/src/main/kotlin/team/codemonsters/ddd/toolkit/domain/subscriberDataUpdate/SubscriberDataUpdateService.kt#L22[–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π]
[source,kotlin]
----
fun dataUpdateProcess(
        dataUpdateRequest: SubscriberDataUpdateRequest
): Mono<Result<SubscriberDataUpdateResponse>> =
   getDataUpdate(dataUpdateRequest)
     .flatMap { getSubscriber(it) }
     .flatMap { prepareSubscriberUpdateRequest(it) }
     .flatMap { updateSubscriber(it) }

 private fun getDataUpdate(
     dataUpdateRequest: SubscriberDataUpdateRequest
): Mono<Result<DataUpdate>> =
     _subscribersClient.findDataUpdate(dataUpdateRequest.dataUpdateId)


private fun getSubscriber(
    dataUpdate: Result<DataUpdate>
): Mono<Result<SubscriberDataUpdate>> =
    Mono.just(dataUpdate)
        .filter { it.isSuccess }
        .flatMap { getSubscriber(it.getOrThrow()) }
        .switchIfEmpty(incomingFailInDataUpdate(dataUpdate))

private fun getSubscriber(
    dataUpdate: DataUpdate
): Mono<Result<SubscriberDataUpdate>> =
    _subscribersClient.findSubscriber(dataUpdate.subscriberId)
        .map {
            SubscriberDataUpdate.emerge(dataUpdate, it)
        }

private fun prepareSubscriberUpdateRequest(
           subscriberDataUpdate: Result<SubscriberDataUpdate>
) : Mono<Result<SubscriberUpdateRequest>> =
  Mono.just(subscriberDataUpdate)
    .filter { it.isSuccess }
    .flatMap { prepareRequest(it.getOrThrow()) }
                //^ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–±–æ–Ω–µ–Ω—Ç–∞
    .switchIfEmpty(
        incomingFailInSubscriberDataUpdate(
            subscriberDataUpdate))

private fun prepareRequest(
         subscriberDataUpdate: SubscriberDataUpdate
): Mono<Result<SubscriberUpdateRequest>> =
    Mono.just(subscriberDataUpdate.prepareUpdateRequest())
              //^ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –î–æ–º–µ–Ω–Ω–æ–º

// updateSubscriber –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏—á–µ–≥–æ, –ø–æ—ç—Ç–æ–º—É
// —è –µ–≥–æ –æ–ø—É—Å—Ç–∏–ª
----

a|

[source,kotlin]
----
suspend fun dataUpdateProcess(
    dataUpdateRequest: SubscriberDataUpdateRequest
): SubscriberDataUpdateResponse {
   val dataUpdate = getDataUpdate(dataUpdateRequest)
   val subscriber = getSubscriber(dataUpdate)
   if (!subscriber.isUpdateRequired()) {
       throw RuntimeException("No Update Required") // (1)
   }
   val updateRequest = subscriber
       .prepareSubscriberUpdateRequest()
   val subscriberUpdateResult = updateSubscriber(it)
   return subscriberUpdateResult
}

private fun getDataUpdate(
    dataUpdateRequest: SubscriberDataUpdateRequest
): DataUpdate =
    _subscribersClient.findDataUpdate(dataUpdateRequest.dataUpdateId)

suspend fun getSubscriber(
    dataUpdate: DataUpdate
): SubscriberDataUpdateRequest {
    val dataUpdateDto =
        _subscribersClient
            .findDataUpdate(dataUpdateRequest.dataUpdateId)

    return SubscriberDataUpdate.emerge(dataUpdate, dataUpdateDto)
}
----

|===

(1) –≤–∑—è–ª –∏–∑ https://git.codemonsters.team/guides/ddd-code-toolkit/src/commit/76cc94ced11f969d934afbfecf30ed7ddcafc5e6/src/main/kotlin/team/codemonsters/ddd/toolkit/domain/subscriberDataUpdate/SubscriberDataUpdate.kt#L22[–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞].

–ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –≤ —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ —á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –ª–æ–≥–∏–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∞—è:

. –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–±–æ–Ω–µ–Ω—Ç–∞
. –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∞–±–æ–Ω–µ–Ω—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º–µ
. —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–±–æ–Ω–µ–Ω—Ç–∞
. –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∞–±–æ–Ω–µ–Ω—Ç–∞

–ò –±–æ–ª–µ–µ —Ç–æ–≥–æ, –≤ —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –µ—â—ë –∏ —Å—Ä–∞–∑—É –ø–æ–¥—Å–≤–µ—á–µ–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ö–æ–¥ —Å—Ü–µ–Ω–∞—Ä–∏—è "–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è".

–ê –≤–æ—Ç —Å–≤–µ–∂–∏–π –ø—Ä–∏–º–µ—Ä —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞ c "–ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∏–º ROP-–æ–º" —É–∂–µ –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ –≠:

[source,kotlin]
----
class AnalysisService(
    private val diaryService: DiaryService,
    private val analysisReportCalculator: AnalysisReportCalculator,
) {

    fun getReportAnalysis(userId: Int, start: Instant, end: Instant): AnalysisReport {
        val reportEvents = diaryService.getReportEvents(userId, start, end)
        val analysisReport = analysisReportCalculator.calculateAnalysisReport(reportEvents, start, end)
        return analysisReport
    }

}
----

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `calculateAnalysisReport` –Ω–∞ 300 —Å—Ç—Ä–æ–∫ –≤ –≤–∏–¥–µ —á–∏—Å—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:

image::ea-at-jpoint-db379.png[]

–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ —ç—Ç–æ—Ç –∫–æ–¥ –ø–∏—Å–∞–ª –Ω–µ —è, –Ω–æ —è –µ–≥–æ —Ä–µ–≤—å—é–≤–∏–ª –∏ –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ –Ω—ë–º —à—Ç–∞–º–ø "–°–æ–æ—Ç–≤–µ—Ç—Å–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –≠–ü".
–ò–º–µ–Ω–Ω–æ —Ç–∞–∫ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–π —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –∫–æ–¥ - —Ç—Ä–∏ –ª–∏–Ω–µ–π–Ω—ã—Ö —Å—Ç—Ä–æ—á–∫–∏ –≤ —Å–µ—Ä–≤–∏—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏ –∫—É—á–∞ —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥–∞ –≤ –¥–æ–º–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ.
